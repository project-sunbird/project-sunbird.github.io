<!DOCTYPE html>
<html>
	<head>
	<base id="baseURL" href="/" />
<script>
	// Dynamic Base URL
	function getBase(){
		excludedSites = ["127.0.0.1:4000", "www.sunbird.org"];
		baseURL = document.getElementById('baseURL');
		if (excludedSites.indexOf(window.location.host) > -1){
			baseURL.href="/";
		} else {
			baseURL.href="/releases/release.1.52.d/";
		}
	}
	getBase();
</script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=10, user-scalable=yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-touch-fullscreen" content="yes" />
<link rel="icon" type="image/png" href="img/favicon/favicon-16x16.png" sizes="16x16">
<meta name="msapplication-TileColor" content="#65d3f7">
<meta name="msapplication-TileImage" content="img/favicon/mstile-150x150.png">

<title>Sunbird Migrate User Data</title>
<meta name="description" content="Sunbird Site Migrate user data from one Sunbird instance to another"/>

<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="pragma" content="no-cache" />
<meta name="last-modified" content="2018-08-06 19:15:49 +0530">
<meta http-equiv="Expires" content="600" />

<!--Build Details-->
<meta name="buildVersion" content="release.1.52.d" />
<meta name="buildNo" content="4444" />
<!--/Build Details-->

<!-- CDN's-->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,600,700" >
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" >
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/4.13.0/bodymovin.js" type="text/javascript"></script>
<!-- /CDN's-->

<link rel="stylesheet" href="css/owl/owl.carousel.min.css?06082018"  />
<link rel="stylesheet" href="css/style.css?06082018"  />
<script type="text/javascript" src="js/bootstrap.min.js?06082018"></script>
<script type="text/javascript" src="js/owl.carousel.min.js?06082018"></script>
<script type="text/javascript" src="js/jquery.tocLight.js?06082018"></script>
<script type="text/javascript" src="js/jquery.elevateZoom-3.0.8.min.js?06082018"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106552125-1"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-106552125-1');
</script>

	
		<meta name="robots" content="index, follow">
	
  </head>
  <body id="body" class="doc-layout">
  <div class="container inner container-height docs">
    <header class="logo-container">
      <div class="logo">
        <a href="index.html">
          <img src="img/sunbird-logo.png" alt="Sunbird docs" title="Sunbird docs">
        </a>
      </div>
      <button type="button" class="dropdown-toggle collapsed" id="dropdown-trigger" data-toggle="collapse" data-target="#mobile-dropdown" aria-expanded="false">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </header>
    <nav class="sidebar-container" id="mobile-dropdown">
      <div class="inner__sidebar">
        <div id="">
     <div class="search-cover">
	<form method="get" action="https://www.google.com/search" target="_blank">
		<input type="text" value="" name="q" placeholder="Search"/ class="search-input" title="Enter keyword to search">
		<input type="hidden" value="en" name="hl" />
		<input type="hidden" name="sitesearch" value="http://www.sunbird.org" />
		<input type="hidden" value="lang_en" name="lr" />
		<button type="submit" onclick="submit()" class="search-btn" title="Search">
			<i class="fa fa-search"></i>
		</button>
	</form>
</div>
 
    <div class="sidebar-wrapper developer-docs-installation">
        <div class="">
            <a href="architecture/">
                <h4 class="sidebar-group-title">Architecture</h4>
            </a>
            <ul class="sidebar-group architecture">
                <li>
                    <a href="architecture/overview/">Overview</a>
                </li>
                <li>
                    <a href="architecture/design/">Design</a>
                </li>
                <li>
                    <div class="">
                        <a href="architecture/views/elementryview/">Views</a>
                        <ul class="sidebar-group">
                            <li>
                                <a href="architecture/views/logical/">Logical View</a>
                            </li>
                            <li>
                                <a href="architecture/views/physical/">Physical View</a>
                            </li>
                            <li>
                                <a href="architecture/views/conceptual/">Conceptual View</a>
                            </li>
                            <li>
                                <a href="architecture/views/deployment/">Deployment View</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="architecture/usecase/">Use Cases</a>
                </li>
            </ul>
            <a href="features-documentation/">
                <h4 class="sidebar-group-title">Product Features</h4>
            </a>
            <ul class="sidebar-group features-documentation">
                <li>
                    <a href="features-documentation/login/">Sign In</a>
                </li>
                <li>
                    <a href="features-documentation/register_org/">Register Organizations</a>
                </li>
                <li>
                    <a href="features-documentation/register_user/">Register Users</a>
                </li>
                <li>
                    <a href="features-documentation/userrolepermission/">User Roles and Permissions</a>
                </li>
                <li>
                    <div class="">
                        <ul class="sidebar-group">
                            <li>
                                <a href="features-documentation/userrole/">Types of Users</a>
                            </li>
                            <li>
                                <a href="features-documentation/userprofile/">User Profile</a>
                            </li>
                            <li>
                                <a href="features-documentation/workspace/">Workspace</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="features-documentation/admindashboard/">Administrator Dashboard</a>
                </li>
                <li>
                    <a href="features-documentation/lessonplan/">Lesson Plan</a>
                </li>
                <li>
                    <a href="features-documentation/book_creation/">Book</a>
                </li>
                <li>
                    <a href="features-documentation/collection_creation/">Collection</a>
                </li>
		<li>
                    <a href="features-documentation/resource_creation/">Resource</a>
                </li>
                <li>
                    <a href="features-documentation/course_intro/">Courses</a>
                </li>
                <li>
                    <div class="">
                        <ul class="sidebar-group">
                            <li>
                                <a href="features-documentation/course_creation/">Course Creation</a>
                            </li>
                            <li>
                                <a href="features-documentation/course_batches/">Batch Creation</a>
                            </li>
                            <li>
                                <a href="features-documentation/course_consumption/">Taking a Course</a>
                            </li>
                        </ul>
                    </div>
				</li>
			<li>
			     <a href="features-documentation/upload/">Uploading Content</a>
                	</li>	
		    		<li>
                    <div class="">
                        <a href="features-documentation/badging_framework/badging_overview/">Badging Framework</a>
                        <ul class="sidebar-group">
                            <li>	
                                <a href="features-documentation/badging_framework/content_badges/">Issuing Badges for Content</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="features-documentation/announcement/">Announcement</a>
                </li>
                <li>
                    <a href="features-documentation/content_review/">Content Review</a>
                </li>
		<li>
                    <a href="features-documentation/library/">Library</a>
                </li>
                <li>
                    <a href="features-documentation/contentlifecycle/">Content Lifecycle</a>
                </li>
                <li>
                    <a href="features-documentation/contenteditor/">Content Editor</a>
                </li>
                <li>
                    <div class="">
                        <a href="features-documentation/guidelines/">Guidelines</a>
                        <ul class="sidebar-group">
                            <li>
                                <a href="features-documentation/intellectualproperty/">Intellectual Property</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="features-documentation/collaborationpartnership/">Collaboration and Partnership</a>
				</li>
				<li>
					<a href="features-documentation/mobileapp/allappfeatures/">Mobile App Features</a>
				</li>
            </ul>
            <a href="usertaskflow/">
				<h4 class="sidebar-group-title">User Task Flows</h4>
			</a>
				<ul class="sidebar-group usertaskflow">
					<li>
						<a href="usertaskflow/how_do_i_create_content/">How do I Create Content</a>
					</li>
						    <li>
								<a href="usertaskflow/how_do_i_add_video/">How do I Add a Video</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_text/">How do I Add Text</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_audio/">How do I Add Audio</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_hotspot/">How do I Add a Hotspot</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_image/">How do I Add an Image</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_shape/">How do I Add Shapes</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_scribblepad/">How do I Add the Scribblepad</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_activity/">How do I Add an Activity</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_create_course/">How do I Create a Course</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_create_book/">How do I Create a Book</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_create_book_with_dial_code/">How do I Add DIAL Codes to a Book</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_create_lessonplan/">How do I Create a Lesson Plan</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_create_collection/">How do I Create a Collection</a>
						    </li>
						    <li>
								<a href="usertaskflow/reviewer_taskflow/">How do I Review Content</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_uploadcontent/">How do I Upload Content</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_delete_content/">How do I Delete Content</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_metadata/">How do I Add Metadata</a>
						    </li>
						    <li>
								<a href="usertaskflow/how_do_i_add_resource/">How do I Add Resource</a>
						    </li>
						    <li>
								<a href="usertaskflow/limited_sharing/">How do I Share Content to a Limited Group</a>
						    </li>
					    </ul>
            <a href="developer-docs/">
                <h4 class="sidebar-group-title">Developer Documentation</h4>
            </a>
            <ul class="sidebar-group developer-docs">
                <!--<li>
                    <a href="developer-docs/getting_started/">Getting Started with Sunbird</a>
                </li>-->          
                <li>
                    <div class="">
                        <a href="developer-docs/installation/">Installation</a>
                        <ul class="sidebar-group">
                            <li>
                                <a href="developer-docs/installation/developer_installation/">Developer Installation</a>
                            </li>
                            <li>
                                <a href="developer-docs/installation/server_installation/">Server Installation</a>
                                <li>
                                    <a href="developer-docs/configuring_sunbird/sso_publickey/">SSO Public Key Configuration</a>
                                </li>
                            </li>
                            <li>
                                <a href="developer-docs/installation/install_mobile_setup/">Mobile App Installation</a>
                            </li>
                            <li>
                                <a href="developer-docs/upgrading/">Upgrading Sunbird</a>
                            </li>
                            <li>
                                    <div class="">
                                        <ul class="sidebar-group">
                                         <li>
                                            <a href="developer-docs/upgrade/upgrade_angular_node/">Upgrading Angular</a>
                                         </li>
                                         </ul>
                                    </div>
                            </li>
                            <li>
                                <a href="developer-docs/installation/static_pages_to_cdn/">Migrate Tenant Pages</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="">
                        <a href="developer-docs/configuring_sunbird/">Configuration</a>
                        <ul class="sidebar-group">
                            <li>
                              <a href="developer-docs/configuring_sunbird/env_variables_portal/">Portal Service Environment Variables</a>
                            </li>    
                            <li>
                              <a href="developer-docs/configuring_sunbird/configuring_domain_ext_links/">Import External Content</a>
                            </li>
                            <li>
				              <a href="developer-docs/configuring_sunbird/env_variables_content_service/">Content Service Environment Variables</a>
                            </li>    
                            <li>
                              <a href="developer-docs/configuring_sunbird/content_filtering/">Content Filtering</a>
                            </li>
                            <li>
                              <a href="developer-docs/configuring_sunbird/metadata_driven_forms/">Configure Metaforms</a>
                            </li>
                            <li>
				                <a href="developer-docs/configuring_sunbird/env_variables_lms/">LMS Service Environment Variables</a>
                            </li>
                            <li>
                             <div class="">
                               <ul class="sidebar-group">
                                <li>
                                  <a href="developer-docs/configuring_sunbird/sso_otpsms/">Configure OTP based SMS</a>
                                </li>
                                </ul>
                             </div>
                            </li>
                          </ul>
                    </div>
                </li>
		        <li>
                    <div class="">
                        <a href="developer-docs/onboarding/">Onboarding</a>
                        <ul class="sidebar-group">
                            <li>
                            <a href="developer-docs/singlesignon/org_user_creation_sso/">Creating Organizations and Users</a>
                            </li>
                            <li>
                            <a href="developer-docs/how-to-guide/how_to_create_user/">Creating Users</a>
                            </li>
					        <li>	
                            <a href="features-documentation/badging_framework/creating_badges/">Creating Badges</a>
					        </li>
					        <li>	
                            <a href="features-documentation/badging_framework/badges_users/">Issuing Badges to Users</a>
					        </li>
					        <li> 
				            <a href="developer-docs/configuring_sunbird/configuring_announcement/">Creating Announcements</a>
                            </li>
                        </ul>
                    </div>
                </li>
                        
                
                <li>
                    <div class="">
                        <a href="developer-docs/telemetry/overview/">Telemetry</a>
                        <ul class="sidebar-group">
                            <li>
                                <a href="developer-docs/telemetry/specification/">Telemetry Specifications</a>
                            </li>
                            <li>
                                <a href="developer-docs/telemetry/sending_telemetry/">Sending Telemetry</a>
                            </li>
                            <li>
                                <div class="">
                                    <ul class="sidebar-group">
                                        <li>
                                            <a href="developer-docs/telemetry/consuming_telemetry/#mobile-app-workflow">Mobile App Workflow</a>
                                        </li>
                                        <li>
                                            <a href="developer-docs/telemetry/consuming_telemetry/#web-portal-workflow">Web Portal Workflow</a>
                                        </li>
                                        <li>
                                            <a href="developer-docs/telemetry/consuming_telemetry/#content-editor-workflow">Content Editor Workflow</a>
                                        </li>
                                        <li>
                                            <a href="developer-docs/telemetry/consuming_telemetry/#backend-services-workflow">Backend-services Workflow</a>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="">
                        <a href="developer-docs/library_reference/">Library References</a>
                        <ul class="sidebar-group">
                            <li>
                                <a href="developer-docs/telemetry/jslibrary/">Standalone JS Library</a>
                            </li>
                            <li>
                                <a href="developer-docs/telemetry/htmlinterfacelibrary/">HTML Interface Library</a>
                            </li>
                            <li>
                                <a href="developer-docs/telemetry/authtokengenerator_jslibrary/">AuthToken Generator JS Library</a>
                            </li>
                            <!--<li>
                                <a href="pages/developer-docs/content-renderer/" target="_blank">Content Renderer</a>
                            </li>
                            <li>
                                <a href="pages/developer-docs/content-editor-framework/" target="_blank">Content Editor Framework</a>
                            </li>
                            <li>
                                <a href="pages/developer-docs/content-editor-plugins/" target="_blank">Content Editor Plugins</a>
                            </li>-->
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="developer-docs/troubleshooting/">Troubleshooting</a>
                </li>
            </ul>
            <a href="apis/">
				<h4 class="sidebar-group-title">API Reference Documentation</h4>
			</a>
            <ul class="sidebar-group apis">
                <li>
                    <a href="apis/#feature" >Feature</a>
                </li>
                <li>
                    <a href="apis/#admin-apis" >Administration</a>
                </li>
                <li>
                    <a href="apis/#setup-apis" >Setup</a>
                </li>
                <li>
                    <a href="apis/#data-apis" >Data</a>
                </li>
            </ul>
            <a href="contributions/">
                <h4 class="sidebar-group-title">Contribute to Sunbird</h4>
            </a>
            <ul class="sidebar-group contributions">
                <li>
                    <a href="contributions/filing_a_bug/">Guidelines for Filing a Bug</a>
                </li>
                <li>
                    <a href="contributions/contribution_guidelines/">Contributing to Sunbird Documentation</a>
                </li>
            </ul>
             <a href="release_notes/">
                <h4 class="sidebar-group-title">Release Notes</h4>
            </a> 
	   <a href="faqs/">
                <h4 class="sidebar-group-title">Frequently asked questions</h4>
            </a>
            <ul class="sidebar-group faqs">
                <li>
                    <a href="faqs/audience/">Audience</a>
                </li>
                <li>
                    <a href="faqs/content_format/">Content Format</a>
                </li>
                <li>
                    <a href="faqs/content_repo/">Content Repositories</a>
                </li>
                <li>
                    <a href="faqs/contentreviews/">Content Review</a>
                </li>
                <li>
                    <a href="faqs/content_types/">Content Types</a>
                </li>
                <li>
                    <a href="faqs/content_upload/">Content Upload</a>
                </li>
                <li>
                    <a href="faqs/feature/">Features</a>
                </li>
                <li>
                    <a href="faqs/fixerrors/">Fix Errors</a>
                </li>
                <li>
                    <a href="faqs/helpsupport/">Help Support</a>
                </li>
                <li>
                    <a href="faqs/intellectual_propertylicensesstandards/">Intellectual Property Licenses Standards</a>
                </li>
                <li>
                    <a href="faqs/registrationenrolment/">Registration and Enrollment</a>
                </li>
                <li>
                    <a href="faqs/signin/">Sign In</a>
                </li>
                <li>
                    <a href="faqs/taxonomymetadataframework/">Taxonomy Meta Data Framework</a>
                </li>
                <li>
                    <a href="faqs/user_rightspermissions/">Users Rights and Permission</a>
                </li>
            </ul>
            <a href="glossary/">
                <h4 class="sidebar-group-title">Glossary</h4>
            </a>
        </div>
    </div>
</div>
<script>
    $("a[href$='developer-docs/installation/migration/']").addClass("sidebar-link-selected");
</script>

      </div>
    </nav>
    <div class="content">
      <div class="inner__content header" id="heading">
        <h1>Migrate User Data </h1>
      </div>

      <div id="main-content" class="inner__content">
			<p class="edit-para text-right">
				<span>
			<a target="_blank" class="contribute" href="contributions/contribution_guidelines">
				  <i class="fa fa-book" aria-hidden="true"></i> <i>Contribution Guidelines</i>
			  </a> &nbsp;&nbsp;
			  
			 <a target="_blank"  title="Edit this page"class="" href="https://github.com/project-sunbird/project-sunbird.github.io/edit/dev/pages/developer-docs/installation/migration.md">
				  <i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit
			  </a> 
			  | 
			  <a target="_blank" href="https://github.com/project-sunbird/project-sunbird.github.io/issues" title="Report issue">
				  <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
				  Report
			  </a>
			  </span>
			</p>
          <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
            <span class="toctoggle">[<a id="toctogglelink" class="internal" href="#">hide</a>]</span>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#overview"><span class="tocnumber">1 .</span> <span class="toctext">Overview</span></a>
            </li>
            <li class="toc_level-1 toc_section-2">
              <a href="#prerequisites"><span class="tocnumber">2 .</span> <span class="toctext">Prerequisites</span></a>
            </li>
            <li class="toc_level-1 toc_section-3">
              <a href="#configuration-parameters"><span class="tocnumber">3 .</span> <span class="toctext">Configuration Parameters</span></a>
            </li>
            <li class="toc_level-1 toc_section-4">
              <a href="#run-the-migration-script"><span class="tocnumber">4 .</span> <span class="toctext">Run the Migration Script</span></a>
            </li>
            <li class="toc_level-1 toc_section-5">
              <a href="#user_external_identity-table-details"><span class="tocnumber">5 .</span> <span class="toctext">user_external_identity Table Details</span></a>
              <ul>
                <li class="toc_level-2 toc_section-6">
                  <a href="#user_external_identity-table-schema"><span class="tocnumber">5.1 .</span> <span class="toctext">user_external_identity Table Schema</span></a>
                </li>
                <li class="toc_level-2 toc_section-7">
                  <a href="#usr_external_identity-table-details"><span class="tocnumber">5.2 .</span> <span class="toctext">usr_external_identity Table Details</span></a>
                </li>
                <li class="toc_level-2 toc_section-8">
                  <a href="#usr_external_identity-table-schema"><span class="tocnumber">5.3 .</span> <span class="toctext">usr_external_identity Table Schema</span></a>
                </li>
              </ul>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><h2 id="overview">Overview</h2>

<p>Sunbird supports multiple external IDs for a user. An external ID is the user’s identity outside the Sunbird system. For example; John is an employee of <strong>XYZ Corporation</strong>.  In <strong>XYZ Corporation</strong>, his identity(ID) is <strong>jo_123</strong> and ID Type is <strong>employeeId</strong>. 
When he registers with Sunbird, he can specify his external ID as  <strong>jo_123</strong>, provider as <strong>XYZ Corporation</strong> and ID Type as <strong>employeeId</strong>. Similarly, John, being part of multiple organizations, (like also being an account holder in <strong>ABC bank</strong>), has a separate identity in each organization. The ID provided by that organization identifies and recognises John as being part of that particular organization. When John is registered in Sunbird, using the create or update user API, he can specify all the external IDs, providers and ID types as values in the associated parameters.</p>

<p>As part of Sunbird release version 1.8, the table holding user external ID data is modified as follows:</p>

<ul>
  <li>The table name is modified from <strong>user_external_identity</strong> to <strong>usr_external_identity</strong>.</li>
  <li>A new column <strong>idtype</strong> is introduced in the <strong>usr_external_identity</strong> table to store external ID type. For example, UIDAI is the provider for ID type Aadhaar.</li>
  <li>In Sunbird release version 1.7, the external ID was unencrypted. In release 1.8, the external ID is encrypted to ensure privacy of user external ID information.</li>
</ul>

<p><strong>Note:</strong> This data migration should be done after deploying Sunbird learner service release version 1.8.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>To run the migration script:</p>

<p>1.Define a mapping file that specifies the ID type for each unique external ID provider available in the <strong>user_external_identity</strong> table.
    a.Get a list of all providers using CQL query: <code>select provider from user_external_identity</code>
    b.Create a CSV file (mapping.csv) that maps each unique external ID to its associated ID type
    For example;
    <code>
    provider,idType
    ka,kaIdType
    ap,apIdType
   </code></p>

<ol>
  <li>Before migrating any data, take a backup in Sunbird keyspace within the Cassandra DB.</li>
</ol>

<h2 id="configuration-parameters">Configuration Parameters</h2>
<p>The following parameters need to be configured for migrating user data:</p>

<table>
  <tbody>
    <tr>
      <td>S.No.</td>
      <td>Parameter</td>
      <td>Description</td>
      <td>Example</td>
    </tr>
    <tr>
      <td>1</td>
      <td>cassandra_server</td>
      <td>Cassandra DB IP Address</td>
      <td>50.34.16.33</td>
    </tr>
    <tr>
      <td>2</td>
      <td>cassandra_port</td>
      <td>Cassandra DB Port Number</td>
      <td>9145</td>
    </tr>
    <tr>
      <td>3</td>
      <td>keyspace_name</td>
      <td>Cassandra DB Keyspace Name</td>
      <td>demodb</td>
    </tr>
    <tr>
      <td>4</td>
      <td>encryption_key</td>
      <td>Key used in Sunbird for encryption of private user information</td>
      <td>60B568970ASDFer321</td>
    </tr>
    <tr>
      <td>5</td>
      <td>provider_idtype_mapping_file_path</td>
      <td>Path to CSV file which defines mapping between external ID provider and type</td>
      <td>\john\mapfile.csv</td>
    </tr>
  </tbody>
</table>

<h2 id="run-the-migration-script">Run the Migration Script</h2>

<p>To migrate user external ID data:</p>

<p>1.Extract the archive file (sunbird-utils/cassandra-migration-etl/r1.8/UserExternalIdentityMigrationBin.zip) that contains the script for user external identity table migration</p>

<p>2.Based on the OS, run the corresponding script to migrate the data</p>

<ul>
  <li>
    <p>For Linux, run the following command:
  <code>
  UserExternalIdentityMigration_run.sh --context_param cassandra_server="{cassandra_server}" --context_param cassandra_port="{cassandra_port}" --context_param cassandra_keyspace="{keyspace_name}" --context_param sunbird_encryption_key="{encryption_key}" --context_param provider_idtype_mapping_file_path="{provider_idtype_mapping_file_path}"
 </code></p>
  </li>
  <li>
    <p>For Windows, run the following command:</p>

    <p><code>
  UserExternalIdentityMigration_run.bat --context_param cassandra_server="{cassandra_server}" --context_param cassandra_port="{cassandra_port}" --context_param cassandra_keyspace="{keyspace_name}" --context_param sunbird_encryption_key="{encryption_key}" --context_param provider_idtype_mapping_file_path="{provider_idtype_mapping_file_path}"
 </code></p>
  </li>
</ul>

<ol>
  <li>Verify that the external IDs are updated in the <strong>usr_external_identity</strong> table with the desired ID type and provider using CQL query: <code>select * from usr_external_identity;</code></li>
</ol>

<h2 id="user_external_identity-table-details">user_external_identity Table Details</h2>

<p><strong>Note</strong> The <strong>user_external_identity</strong> table is used prior to Sunbird release version 1.8</p>

<table>
  <tbody>
    <tr>
      <td>S.No.</td>
      <td>Field</td>
      <td>Description</td>
    </tr>
    <tr>
      <td>1</td>
      <td>id</td>
      <td>Identity of the record. This is the primary key</td>
    </tr>
    <tr>
      <td>2</td>
      <td>createdby</td>
      <td>The User ID of the person who created the record</td>
    </tr>
    <tr>
      <td>3</td>
      <td>createdon</td>
      <td>The date and time when the record was inserted into the database</td>
    </tr>
    <tr>
      <td>4</td>
      <td>externalid</td>
      <td>The user’s identity apart from the Sunbird system. This field allows other systems fetch records from Sunbird and co-relate the user within their system using a combination of the externalid and provider</td>
    </tr>
    <tr>
      <td>5</td>
      <td>provider</td>
      <td>The provider of the external ID. This can be any organisation</td>
    </tr>
    <tr>
      <td>6</td>
      <td>lastupdatedon</td>
      <td>The date on which the record was last updated</td>
    </tr>
    <tr>
      <td>7</td>
      <td>userid</td>
      <td>The User’s identity within Sunbird</td>
    </tr>
  </tbody>
</table>

<h3 id="user_external_identity-table-schema">user_external_identity Table Schema</h3>

<p>
  <code>
user_external_identity (
    id text PRIMARY KEY,
    createdby text,
    createdon timestamp,
    externalid text,
    lastupdatedby text,
    lastupdatedon timestamp,
    provider text,
    userid text
)
</code>
</p>

<h3 id="usr_external_identity-table-details">usr_external_identity Table Details</h3>

<p><strong>Note</strong> The <strong>usr_external_identity</strong> table is used from Sunbird release version 1.8</p>

<table>
  <tbody>
    <tr>
      <td>S.No.</td>
      <td>Field</td>
      <td>Description</td>
    </tr>
    <tr>
      <td>1</td>
      <td>provider</td>
      <td>The provider of the external ID. This can be any organisation</td>
    </tr>
    <tr>
      <td>2</td>
      <td>idtype</td>
      <td>The type of ID for example; employee ID, student ID, etc.</td>
    </tr>
    <tr>
      <td>3</td>
      <td>externalid</td>
      <td>The user’s identity apart from the Sunbird system. This field allows other systems fetch records from Sunbird and co-relate the user within their system using a combination of the externalid and provider</td>
    </tr>
    <tr>
      <td>4</td>
      <td>createdby</td>
      <td>The User ID of the person who created the record</td>
    </tr>
    <tr>
      <td>5</td>
      <td>createdon</td>
      <td>The date and time when the record was inserted into the database</td>
    </tr>
    <tr>
      <td>6</td>
      <td>lastupdatedon</td>
      <td>The date on which the record was last updated</td>
    </tr>
    <tr>
      <td>7</td>
      <td>userid</td>
      <td>The User’s identity within Sunbird</td>
    </tr>
  </tbody>
</table>

<p><strong>Note:</strong> The combination of provider, idtype and externalid must be unique. The system uses this combination as a primary Key.</p>

<h3 id="usr_external_identity-table-schema">usr_external_identity Table Schema</h3>

<p>
  <code>
usr_external_identity (
    provider text,
    idtype text,
    externalid text,
    createdby text,
    createdon timestamp,
    lastupdatedby text,
    lastupdatedon timestamp,
    userid text,
    PRIMARY KEY (provider, idtype, externalid)
)
</code>
</p>

          
          <hr />
          
          <p class="edit-para text-right">
			<a target="_blank" href="https://github.com/project-sunbird/project-sunbird.github.io/edit/dev/pages/developer-docs/installation/migration.md" title="Fix this page">
				<i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit</a> |
			<a target="_blank" href="https://github.com/project-sunbird/project-sunbird.github.io/issues" title="Report issue">
				<i class="fa fa-exclamation-circle" aria-hidden="true"></i> Report</a>
		  </p>
		  <a href="developer-docs/installation/migration/#heading" class="scrollup"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a>
          
      </div>
    </div>
    <div class="page-footer">
		<footer class="footer">
	<div class="footer__top">
		<div class="container">
			<div class="row">
				
			<div class="col-md-4 col-sm-12">
			</div>
			
			<div class="col-md-2 col-sm-6 ">
				<ul>
					<li><a href="about/">About Sunbird</a></li>
					<li><a href="contact/">Contact Us</a></li>
					<li><a href="privacy-policy/">Privacy Policy</a></li>
				</ul>
			</div>
			
			<div class="col-md-2 col-sm-6 sideline">
				<ul>
					<li><a href="docs/">Documentation</a></li>
					<li><a href="features/">Features</a></li>
				</ul>
			</div>

			<div class="col-md-2 col-sm-12">
			</div>
			
		</div>
	</div>
</footer>
 

	</div>
  </div>
  <script type="text/javascript">
	//TOC Toggle
    $(function() {
        $.toc.clickHideButton();
    });
    //Scroll to top
    $(document).ready(function () {
		$(".content").scroll(function () {
			if ($(this).scrollTop() > 250) {
				$('.scrollup').fadeIn();
			} else {
				$('.scrollup').fadeOut();
			}
		});
	});
	$('#toc a').each(function(){
		var url = this.href.replace(baseURL.href, "");
		this.href = 'developer-docs/installation/migration/' + url;
    })
	$(".zoomcover").click(function(){
		if (!$(this).hasClass("fullscreen")){
			$(this).addClass("fullscreen");
			$(this).find(".zoom").addClass("enabled").elevateZoom({
				zoomType: "inner",
				cursor  : "crosshair",
				scrollZoom: "true"
			});
		} else {
			$(this).removeClass("fullscreen");
			$(this).find(".zoom").removeClass("enabled");
			$(".zoomContainer").hide();
		}
	});
	$(document).keyup(function(e) {
     if (e.keyCode == 27) { 
		$(".zoomcover").removeClass("fullscreen");
		$(".zoomcover").find(".zoom").removeClass("enabled");
		$(".zoomContainer").hide();
    }
});
  </script>
  <style>
  .zoom:hover{
	cursor:url(img/zoom.png),crosshair;
  }
  .zoomWindowContainer:hover div{
	cursor:url(img/scroll.png),crosshair !important;
	height:15px;
	width:15px;
  }
  </style>
  </body>
</html>
