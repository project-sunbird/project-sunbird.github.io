<!DOCTYPE html>
<html>
	<head>
	<base id="baseURL" href="/">
<script>
	baseURL = document.getElementById('baseURL');
	// Dynamic Base URL
	/*function getBase(){
		excludedSites = ["127.0.0.1:4000", "www.sunbird.org"];
		if (excludedSites.indexOf(window.location.host) > -1){
			baseURL.href="/";
		} else {
			baseURL.href="";
		}
	}
	getBase();*/
</script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-touch-fullscreen" content="yes" />
<link rel="icon" type="image/png" href="img/favicon/favicon-16x16.png" sizes="16x16">
<meta name="msapplication-TileColor" content="#65d3f7">
<meta name="msapplication-TileImage" content="img/favicon/mstile-150x150.png">

<title>Sunbird Server Automation via Azure and Manually</title>
<meta name="description" content="Sunbird Site Provisioning server"/>

<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Cache-Control" content="no-store" />
<meta http-equiv="pragma" content="no-cache" />
<meta name="last-modified" content="2017-12-04 23:01:45 +0530">
<meta http-equiv="Expires" content="600" />

<!--Build Details-->
<!--<meta name="buildVersion" content="" />
<meta name="buildNo" content="" />-->
<!--/Build Details-->

<!-- CDN's-->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,600,700" >
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" >
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<!-- /CDN's-->

<link rel="stylesheet" href="css/owl/owl.carousel.min.css?04122017"  />
<link rel="stylesheet" href="css/style.css?04122017"  />
<script type="text/javascript" src="js/bootstrap.min.js?04122017"></script>
<script type="text/javascript" src="js/owl.carousel.min.js?04122017"></script>
<script type="text/javascript" src="js/jquery.tocLight.js?04122017"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106552125-1"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-106552125-1');
</script>

	
		<meta name="robots" content="index, follow">
	
  </head>
  <body id="body">
  <div class="container inner container-height docs">
    <header class="logo-container">
      <div class="logo">
        <a href="index.html">
          <img src="img/sunbird-logo.png" alt="Sunbird docs" title="Sunbird docs">
        </a>
      </div>
      <button type="button" class="dropdown-toggle collapsed" id="dropdown-trigger" data-toggle="collapse" data-target="#mobile-dropdown" aria-expanded="false">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </header>
    <nav class="sidebar-container" id="mobile-dropdown">
      <div class="inner__sidebar">
        <div id="">
	
		<div class="search-cover">
	<form method="get" action="https://www.google.com/search" target="_blank">
		<input type="text" value="" name="q" placeholder="Search"/ class="search-input" title="Enter keyword to search">
		<input type="hidden" value="en" name="hl" />
		<input type="hidden" name="sitesearch" value="http://www.sunbird.org" />
		<input type="hidden" value="lang_en" name="lr" />
		<button type="submit" onclick="submit()" class="search-btn" title="Search">
			<i class="fa fa-search"></i>
		</button>
	</form>
</div>

	
	<div class="sidebar-wrapper developer-docs-installation">
		<div class="" >
			<a href="architecture/">
				<h4 class="sidebar-group-title">Architecture</h4>
			</a>
			<ul class="sidebar-group architecture">
				<li>
					<a href="architecture/overview/">Overview</a>
				</li>
				<li>
					<a href="architecture/design/">Design</a>
				</li>
				<li>
					<div class="">
						<a href="architecture/views/elementryview/">Views</a>
						<ul class="sidebar-group">
							<li>
								<a href="architecture/views/logical/">Logical View</a>
							</li>
							<li>
								<a href="architecture/views/physical/">Physical View</a>
							</li>
							<li>
								<a href="architecture/views/conceptual/">Conceptual View</a>
							</li>
							<li>
								<a href="architecture/views/deployment/">Deployment View</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="architecture/usecase/">Use Cases</a>
				</li>
			</ul>
			<a href="features-documentation/">
				<h4 class="sidebar-group-title">Product Features</h4>
			</a>
			<ul class="sidebar-group features-documentation" >
				<li>
					<a href="features-documentation/onboarding/">Onboarding</a>
				</li>
				<li>
					<a href="features-documentation/login/">Login</a>
				</li>
				<li>
					<a href="features-documentation/administration/">Administration</a>
					<ul class="sidebar-group">
						<li>
							<a href="features-documentation/register_org/">Register Organizations</a>
						</li>
						<li>
							<a href="features-documentation/register_user/">Register Users</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="features-documentation/userrolepermission/">User Roles and Permissions</a>
				</li>
				<li>
					<div class="">
						<ul class="sidebar-group">
							<li>
								<a href="features-documentation/userprofile/">User Profile</a>
							</li>
							<li>
								<a href="features-documentation/workspace/">Workspace</a>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="features-documentation/coursetraining/">Courses and Training</a>
				</li>
				<li>
					<a href="features-documentation/library/">Library</a>
				</li>
				<li>
					<a href="features-documentation/contentlifecycle/">Content Lifecycle</a>
				</li>
				<li>
					<a href="features-documentation/contentcreation/">Content Creation</a>
				</li>
				<li>
					<a href="features-documentation/contenteditor/">Content Editor</a>
				</li>
				<!--<li>
					<a href="features-documentation/consumption/">Consume Study Material</a>
				</li>-->
				</li>
				<li>
					<div class="">
						<a href="features-documentation/guidelines/" >Guidelines</a>
						<ul class="sidebar-group">
							<li>
								<a href="features-documentation/intellectualproperty/">Intellectual Property</a>
							</li>
						</ul>
					</div>
				</li>
				<!--<li>
					<a href="features-documentation/reportinganalytics/">Reporting and Analytics</a>
				</li>-->
				<li>
					<a href="features-documentation/collaborationpartnership/">Collaboration and Partnership</a>
				</li>
				</ul>
				<a href="developer-docs/">
					<h4 class="sidebar-group-title">Developer Documentation</h4>
				</a>
				<ul class="sidebar-group developer-docs">
					<li>
						<a href="developer-docs/installation/">Installation Overview</a>
					</li>
					<!--<li>
						<a href="developer-docs/hosting_sunbird/">Hosting Sunbird</a>
					</li>-->
					<li>
						<a  href="developer-docs/installation/installing_sunbirdon_laptop/">Install Sunbird on Laptop</a>
					</li>
					<li>
						<div class="">
							<a href="developer-docs/installation/medium_scale_deploy/">Medium Scale Deployment</a>
							<ul class="sidebar-group">
								<li>
									<a href="developer-docs/installation/provisioning_servers/">Provisioning Servers</a>
								</li>
								<li>
									<a href="developer-docs/installation/setup_db/">Setup Databases</a>
								</li>
								<li>
									<a href="developer-docs/installation/deploy_sb_services/">Deploying Sunbird Services</a>
								</li>
								<li>
									<a href="developer-docs/installation/keycloak_realm_configuration/">Configure Keycloak</a>
								</li>
								<li>
									<a href="developer-docs/installation/cust_sunbird/">Customizing Assets</a>
								</li>
								<li>
									<a href="developer-docs/installation/check_installation/">Check Installation</a>
								</li>
								<!--<li>
									<a href="developer-docs/installation/keycloak_sms_authenticator/">Authentication</a>
								</li>-->
							</ul>
						</div>
					</li>
					<li>
						<a href="developer-docs/installation/install_mobile_setup/">Mobile App Installation</a>
					</li>
					<!--<li>
						<div class="">
							<a class="sidebar-group-title" href="developer-docs/extending_sunbird/">Extending Sunbird</a>
						</div>
					</li>
					<li>
						<div class="">
							<a class="sidebar-group-title" href="developer-docs/customize_sunbird/">Customizing Sunbird</a>
						</div>
					</li>-->
					<li>
						<div class="">
							<a  href="apis/">API References</a>
							<ul class="sidebar-group">
								<li>
									<a href="apis/bulkupload/" target="_blank">Bulk Upload Service APIs</a>
								</li>
								<li>
									<a href="apis/content/" target="_blank">Content APIs</a>
								</li>
								<li>
									<a href="apis/coursebatchmanapi/" target="_blank">Course Batch Management APIs</a>
								</li>
								<li>
									<a href="apis/datasyncapi/" target="_blank">Data Sync APIs</a>
								</li>
								<li>
									<a href="apis/metricsapi/" target="_blank">Metrics APIs</a>
								</li>
								<li>
									<a href="apis/notificationapi/" target="_blank">Notification APIs</a>
								</li>
								<li>
									<a href="apis/orgapi/" target="_blank">Organisation Management APIs</a>
								</li>
								<li>
									<a href="apis/userapi/" target="_blank">User APIs</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="developer-docs/troubleshooting/">Troubleshooting</a>
					</li>
				</div>
			</li>
		</ul>
		<a href="faqs/">
			<h4 class="sidebar-group-title">Frequently asked questions</h4>
		</a>
		<ul class="sidebar-group faqs" >
			<li>
				<a href="faqs/audience/">Audience</a>
			</li>
			<li>
				<a href="faqs/content_format/">Content Format</a>
			</li>
			<li>
				<a href="faqs/content_repo/">Content Repositories</a>
			</li>
			<li>
				<a href="faqs/contentreviews/">Content Review</a>
			</li>
			<li>
				<a href="faqs/content_types/">Content Types</a>
			</li>
			<li>
				<a href="faqs/content_upload/">Content Upload</a>
			</li>
			<li>
				<a href="faqs/feature/">Features</a>
			</li>
			<li>
				<a href="faqs/fixerrors/">Fix Errors</a>
			</li>
			<li>
				<a href="faqs/helpsupport/">Help Support</a>
			</li>
			<li>
				<a href="faqs/intellectual_propertylicensesstandards/">Intellectual Property Licenses Standards</a>
			</li>
			<li>
				<a href="faqs/registrationenrolment/">Registration and Enrollment</a>
			</li>
			<li>
				<a href="faqs/signin/">Sign In</a>
			</li>
			<li>
				<a href="faqs/taxonomymetadataframework/">Taxonomy Meta Data Framework</a>
			</li>
			<li>
				<a href="faqs/user_rightspermissions/">Users Rights and Permission</a>
			</li>
		</ul>
		<a href="glossary/">
			<h4 class="sidebar-group-title">Glossary</h4>
		</a>
	</div>
</div>
<script>
$("a[href$='developer-docs/installation/provisioning_servers/']").addClass("sidebar-link-selected");
</script>

      </div>
    </nav>
    <div class="content">
      <div class="inner__content header" id="heading">
        <h1>Provisioning Servers </h1>
      </div>

      <div id="main-content" class="inner__content">
			<p class="edit-para text-right">
				<span>
			<a target="_blank" class="contribute" href="contributions/contribution_guidelines">
				  <i class="fa fa-book" aria-hidden="true"></i> <i>Contribution Guidelines</i>
			  </a> &nbsp;&nbsp;
			  
			 <a target="_blank"  title="Edit this page"class="" href="https://github.com/project-sunbird/project-sunbird.github.io/edit/dev/pages/developer-docs/installation/provisioning_servers.md">
				  <i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit
			  </a> 
			  | 
			  <a target="_blank" href="https://github.com/project-sunbird/project-sunbird.github.io/issues" title="Report issue">
				  <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
				  Report
			  </a>
			  </span>
			</p>
          <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
            <span class="toctoggle">[<a id="toctogglelink" class="internal" href="#">hide</a>]</span>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#link1-1"><span class="tocnumber">1 .</span> <span class="toctext">Automation for Azure</span></a>
              <ul>
                <li class="toc_level-2 toc_section-2">
                  <a href="#link1-1-1"><span class="tocnumber">1.1 .</span> <span class="toctext">Automation walkthrough</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-3">
              <a href="#link1-3"><span class="tocnumber">2 .</span> <span class="toctext">Manual Process</span></a>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><p>Follow either an automated or manual process to provision the servers. For setup in a non-production environment, use only the manual process. Use the automated process if you are setting up Sunbird and are not sure of setting up the infrastructure correctly, or if you plan to roll out your implementation to serious users.</p>

<h2 id="link1-1">Automation for Azure</h2>

<p>The set of scripts on the Automation for Azure page creates the network and servers needed to run Sunbird. The default configuration procedure provisions for three servers, with the minimum specifications mentioned in the System requirements section.
Known-how of  Azure: VNet, Resource Group, etc. is beneficial but not mandatory.</p>

<p>The automated provisioning of servers is done via Automation for Azure. The automated provisioning setup:</p>

<ul>
  <li>Azure Virtual Network (aka VPC in AWS)</li>
  <li>Creates multiple subnets (one for swarm master, one for swarm slave machines and DB servers)</li>
  <li>Creates master servers, a replication set of slaves (so that you can add or subtract slave nodes easily),load balancers for master and slaves</li>
  <li>Opens up ports for communication between servers, creates a DB server, sets up FQDNs and runs the Docker Swarm</li>
</ul>

<p>Estimated run time: 30 mins for the fresh  time.</p>

<p>Scripts can be re-tried and to create a new set of servers every time. Some configurations cannot be changed, for instance, the server type. However, itâ€™s possible to add or reduce the number of servers and re-run the automation process, if you plan for scaling up or down.</p>

<p>Run the following steps from a machine which is connected to the internet:</p>

<ol>
  <li>Clone the sunbird-devops repo using <code>git clone https://github.com/project-sunbird/sunbird-devops.git</code></li>
  <li>Run <code>./sunbird-devops/deploy/generate-config.sh mysb production cloud</code> This will create config files for you in <code>./mysb-devops/test/azure</code>.</li>
  <li>Here, <code>mysb</code> is the <strong>implementation-name</strong> and <code>production</code> is the <strong>environment-name</strong>.</li>
  <li>Edit both the new config files <code>azuredeploy.parameters.json</code> and <code>env.sh</code> as per your requirements for the app.</li>
  <li>Edit the new config files <code>azuredeploy.parameters.json</code> and <code>env.sh</code> as per your requirements for the db.</li>
  <li>Run <code>export APP_DEPLOYMENT_JSON_PATH=&lt;absolute path of azuredeploy.parameters.json&gt;</code>. For instance, on my laptop it is <code>export DEPLOYMENT_JSON_PATH=/Users/shashankt/code2/sunbird/mysb-devops/production/azure/app</code></li>
  <li>Run <code>export DB_DEPLOYMENT_JSON_PATH=&lt;absolute path of azuredeploy.parameters.json&gt;</code>. For instance, on my laptop it is <code>export DEPLOYMENT_JSON_PATH=/Users/shashankt/code2/sunbird/mysb-devops/production/azure/db</code></li>
  <li>Run <code>cd sunbird-devops/deploy</code></li>
  <li>Run <code>./provision-servers.sh</code></li>
  <li>Login to Azure when CLI instructs to</li>
  <li>Wait for deployment to complete</li>
  <li>Check on Azure portal: Resource Group -&gt; Deployments -&gt; Click on deployment to see deployment details</li>
  <li>Try to SSH. If your <code>masterFQDN</code> from deployment details was <code>production-1a.centralindia.cloudapp.azure.com</code> you can ssh using <code>ssh -A ops@production-1a.centralindia.cloudapp.azure.com</code></li>
  <li>If you could SSH, you have successfully created the server platform.</li>
</ol>

<p><strong>Note:</strong> The automation walk-throughs provided (PART 1) , (PART2), shows you the automated process. You can use them to understand the commands to be used and assist you in the process for provisioning the servers.</p>

<h3 id="link1-1-1">Automation walkthrough</h3>

<p>
  <a href="https://sunbirdpublic.blob.core.windows.net/installation/demo/demo-1.gif" target="_blank">Part 1</a>
</p>

<p>
  <a href="https://sunbirdpublic.blob.core.windows.net/installation/demo/demo-2.gif" target="_blank">Part 2</a>
</p>

<p><strong>Note:</strong> The default automation process creates three servers because it separates the application and the administration server.</p>

<h2 id="link1-3">Manual Process</h2>

<p>The manual procedure commissions two servers. The first server, serves as the DB(Database) server and the second serves as the application server &amp; administration server.</p>

<p>If you wish to set up manually, the main requirement is to have Docker Swarm installed and working (multi node cluster), servers available to install the DB and ports open for communication.</p>


          
          <hr />
          
          <p class="edit-para text-right">
			<!--<a target="_blank"  class="" href="">
				  <i>Contribution Guidelines</i>
			  </a> &nbsp;&nbsp;-->
			<a target="_blank" href="https://github.com/project-sunbird/project-sunbird.github.io/edit/dev/pages/developer-docs/installation/provisioning_servers.md" title="Fix this page">
				<i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit</a> |
			<a target="_blank" href="https://github.com/project-sunbird/project-sunbird.github.io/issues" title="Report issue">
				<i class="fa fa-exclamation-circle" aria-hidden="true"></i> Report</a>
		  </p>
		  <a href="developer-docs/installation/provisioning_servers/#heading" class="scrollup"><i class="fa fa-arrow-circle-up" aria-hidden="true"></i></a>
          
      </div>
    </div>
    <div class="page-footer">
		<footer class="footer">
	<div class="footer__top">
		<div class="container">
			<div class="row">
				
			<div class="col-md-4 col-sm-12">
			</div>
			
			<div class="col-md-2 col-sm-6 ">
				<ul>
					<li><a href="about/">About Sunbird</a></li>
					<li><a href="contact/">Contact Us</a></li>
					<li><a href="privacy-policy/">Privacy Policy</a></li>
				</ul>
			</div>
			
			<div class="col-md-2 col-sm-6 sideline">
				<ul>
					<li><a href="docs/">Documentation</a></li>
					<li><a href="features/">Features</a></li>
				</ul>
			</div>

			<div class="col-md-2 col-sm-12">
			</div>
			
		</div>
	</div>
</footer>

	</div>
  </div>
  <script type="text/javascript">
	//TOC Toggle
    $(function() {
        $.toc.clickHideButton();
    });
    //Scroll to top
    $(document).ready(function () {
		$(".content").scroll(function () {
			if ($(this).scrollTop() > 250) {
				$('.scrollup').fadeIn();
			} else {
				$('.scrollup').fadeOut();
			}
		});
	});
	$('#toc a').each(function(){
		var url = this.href.replace(baseURL.href, "");
		this.href = 'developer-docs/installation/provisioning_servers/' + url;
    })
  </script>
  </body>
</html>
